name: Update SUMMARY.md

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  generate-summary:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Generate Summary
      run: |
        cd src
        find . -type f | while read file; do
          echo "- [${file#./}]($file)" >> SUMMARY.md
        done

    - name: Commit and push if changed
      run: |
        git config --global user.name 'Your Name'
        git config --global user.email 'your-email@users.noreply.github.com'
        git add src/SUMMARY.md
        git commit -m "Update SUMMARY.md" || exit 0
        git push
